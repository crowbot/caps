{% extends "base.html" %}

{% block title %}Search results{% endblock %}

{% block content %}

<h1>Search</h1>

<form method="get" action="{% url 'search_results' %}">
    <table>
        {{ form.as_table }}
        <tr>
            <td>&nbsp;</td>
            <td>
                <input type="submit" value="Search">
            </td>
        </tr>
    </table>

    {% if query %}
        <h3>Results</h3>
        {% if page_obj.paginator.count == 1 %}
            {{ page_obj.paginator.count }} result.
        {% else %}
            {{ page_obj.paginator.count }} results.
        {% endif %}

        {% for result in page_obj.object_list %}
            <p>
                <a href="{% url 'council' result.object.council.slug %}">{{ result.object.council.name }}</a>
                <a href="{{ result.object.file.url }}">Plan document</a>

                {% for text in result.highlighted.text %}
                    <br>
                    {% autoescape off %}{{ text }}{% endautoescape %}
                {% endfor %}
            </p>
        {% empty %}
            <p>No results found.</p>
        {% endfor %}

        {% if page_obj.has_previous or page_obj.has_next %}
            <div>
                {% if page_obj.has_previous %}<a href="?q={{ query }}&amp;page={{ page_obj.previous_page_number }}">{% endif %}&laquo; Previous{% if page_obj.has_previous %}</a>{% endif %}
                |
                {% if page_obj.has_next %}<a href="?q={{ query }}&amp;page={{ page_obj.next_page_number }}">{% endif %}Next &raquo;{% if page_obj.has_next %}</a>{% endif %}
            </div>
        {% endif %}
    {% endif %}
</form>
{% endblock %}
